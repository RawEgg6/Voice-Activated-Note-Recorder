[{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/app.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/controllers/auth.controller.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/controllers/recordings.controller.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'searchRecordingsService' is not defined.","line":98,"column":27,"nodeType":"Identifier","messageId":"undef","endLine":98,"endColumn":50}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  saveRecording,\n  fetchRecordings,\n  fetchRecordingById,\n  updateRecordingService,\n  deleteRecordingService\n} from \"../services/recordings.service.js\";\n\n\nexport const createRecording = async (req, res) => {\n  try {\n    const { title, lang } = req.body;\n\n    if (!title) {\n      return res.status(400).json({ error: \"Title is required\" });\n    }\n\n    if (!req.file) {\n      return res.status(400).json({ error: \"No audio file uploaded\" });\n    }\n    console.log(\"Creating recording with lang:\", lang);\n\n    const result = await saveRecording(req.userId, title, req.file.path, lang);\n\n    return res.status(201).json(result);\n  } catch (err) {\n    return res.status(500).json({ error: err.message });\n  }\n};\n\nexport const getUserRecordings = async (req, res) => {\n  try {\n    const recordings = await fetchRecordings(req.userId);\n    res.json(recordings);\n  } catch (err) {\n    res.status(500).json({ error: err.message });\n  }\n};\n\nexport const getRecordingById = async (req, res) => {\n  try {\n    const id = req.params.id;\n    const recording = await fetchRecordingById(id, req.userId);\n\n    if (!recording) {\n      return res.status(404).json({ error: \"Recording not found\" });\n    }\n\n    res.json(recording);\n\n  } catch (err) {\n    res.status(500).json({ error: err.message });\n  }\n};\n\nexport const updateRecording = async (req, res) => {\n  try {\n    const id = req.params.id;\n    const { title, transcript_text } = req.body;\n\n    if (!title && !transcript_text) {\n      return res.status(400).json({ error: \"Nothing to update\" });\n    }\n\n    const updated = await updateRecordingService(id, req.userId, { title, transcript_text });\n\n    if (!updated) {\n      return res.status(404).json({ error: \"Recording not found or not yours\" });\n    }\n\n    res.json({ message: \"Recording updated successfully\" });\n\n  } catch (err) {\n    res.status(500).json({ error: err.message });\n  }\n};\n\nexport const deleteRecording = async (req, res) => {\n  try {\n    const id = req.params.id;\n\n    const deleted = await deleteRecordingService(id, req.userId);\n\n    if (!deleted) {\n      return res.status(404).json({ error: \"Recording not found or not yours\" });\n    }\n\n    return res.json({ message: \"Recording deleted successfully\" });\n\n  } catch (err) {\n    return res.status(500).json({ error: err.message });\n  }\n};\n\nexport const searchRecordings = async (req, res) => {\n  try {\n    const q = req.query.q || \"\";\n    const results = await searchRecordingsService(req.userId, q);\n    res.json(results);\n  } catch (err) {\n    res.status(500).json({ error: err.message });\n  }\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/db/database.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/middleware/auth.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":22,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { verifyToken } from \"../utils/jwt.js\";\n\nexport const authMiddleware = (req, res, next) => {\n  try {\n    const authHeader = req.headers.authorization;\n\n    if (!authHeader) {\n      return res.status(401).json({ error: \"No token provided\" });\n    }\n\n    const [scheme, token] = authHeader.split(\" \");\n\n    if (scheme !== \"Bearer\" || !token) {\n      return res.status(401).json({ error: \"Invalid token format\" });\n    }\n\n    const decoded = verifyToken(token);\n\n    req.userId = decoded.userId; // attach user ID for the route to use\n\n    next();\n  } catch (err) {\n    return res.status(401).json({ error: \"Invalid or expired token\" });\n  }\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/routes/auth.routes.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/routes/recordings.routes.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/routes/test.routes.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/services/auth.service.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/services/recordings.service.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":81,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import db from \"../db/database.js\";\nimport { transcribeAudio } from \"./whisper.service.js\";\n\nexport const saveRecording = async (userId, title, audioPath, lang) => {\n  const transcript = await transcribeAudio(audioPath, lang);\n\n  const result = await db.run(\n    \"INSERT INTO recordings (user_id, title, audio_path, transcript_text) VALUES (?, ?, ?, ?)\",\n    [userId, title, audioPath, transcript]\n  );\n\n  const id = result.lastID;\n\n  return {\n    id,\n    title,\n    audio_path: audioPath,\n    transcript_text: transcript\n  };\n};\n\nexport const fetchRecordings = async (userId) => {\n  const rows = await db.all(\n    \"SELECT id, title, audio_path, transcript_text, created_at FROM recordings WHERE user_id = ? ORDER BY created_at DESC\",\n    [userId]\n  );\n\n  return rows;\n};\n\nexport const fetchRecordingById = async (id, userId) => {\n  const row = await db.get(\n    \"SELECT id, title, audio_path, transcript_text, created_at FROM recordings WHERE id = ? AND user_id = ?\",\n    [id, userId]\n  );\n\n  return row; // may be null if not found\n};\n\nexport const updateRecordingService = async (id, userId, { title, transcript_text }) => {\n  const fields = [];\n  const values = [];\n\n  if (title) {\n    fields.push(\"title = ?\");\n    values.push(title);\n  }\n\n  if (transcript_text) {\n    fields.push(\"transcript_text = ?\");\n    values.push(transcript_text);\n  }\n\n  // update timestamp\n  fields.push(\"updated_at = CURRENT_TIMESTAMP\");\n\n  values.push(id, userId);\n\n  const result = await db.run(\n    `UPDATE recordings SET ${fields.join(\", \")} WHERE id = ? AND user_id = ?`,\n    values\n  );\n\n  return result.changes > 0;\n};\n\nimport fs from \"fs\";\n\nexport const deleteRecordingService = async (id, userId) => {\n  // First get the audio path so we can delete the file\n  const recording = await db.get(\n    \"SELECT audio_path FROM recordings WHERE id = ? AND user_id = ?\",\n    [id, userId]\n  );\n\n  if (!recording) return false;\n\n  // Remove file from disk\n  try {\n    fs.unlinkSync(recording.audio_path);\n  } catch (err) {\n    console.warn(\"File not found, but DB entry will still be deleted.\");\n  }\n\n  // Delete DB row\n  const result = await db.run(\n    \"DELETE FROM recordings WHERE id = ? AND user_id = ?\",\n    [id, userId]\n  );\n\n  return result.changes > 0;\n};\n\nexport const searchRecordingsService = async (userId, q) => {\n  const like = `%${q}%`;\n\n  const rows = await db.all(\n    `SELECT id, title, transcript_text, audio_path, created_at\n     FROM recordings\n     WHERE user_id = ?\n     AND (title LIKE ? OR transcript_text LIKE ?)\n     ORDER BY created_at DESC`,\n    [userId, like, like]\n  );\n\n  return rows;\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/services/whisper.service.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/utils/hash.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/vikramadityasharma/Desktop/Projects/Voice_notes_app/backend/src/utils/jwt.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]